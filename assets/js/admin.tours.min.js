(function(a,b){vrAdmin.Tours={Controls:{getProperty:function(c,e){var d=b(c).parent().parent().data();return d.tour[e]}},addNew:function(){b.ajax({url:"index.php",type:"POST",data:{view:"tour",task:"ajaxGetTourHtml"},async:true,cache:false}).done(function(d,e,c){if(d.status){b("#vrTour .modal-title").html('<i class="fa fa-plus-square" aria-hidden="true"></i> New tour');b("#vrTour .modal-body .container-fluid").html(d.data.html);b("#vrTour").modal("show");b(".addPano").click()}});b("#vrTour").modal("show")},showEmbed:function(c){b(c).find(".embedCode").on("click",function(f){var d=vrAdmin.Tours.Controls.getProperty(this,"alias");var e='<iframe width="800px" height="400px" src="http://vr360.globalvision.ch/'+d+'" ></iframe>';b("#vrModal .modal-body").text(e);b("#vrModal").modal("show")})},showEdit:function(c){var d=b(c).data();b(c).find(".editTour").on("click",function(e){b.ajax({url:"index.php",type:"POST",data:{id:d.tour.id,view:"tour",task:"ajaxGetTourHtml"},async:true,cache:false}).done(function(g,h,f){if(g.status){b("#vrTour .modal-title").html('<i class="fa fa-plus-square" aria-hidden="true"></i> Edit tour <br/><small>'+d.tour.name+"</small>");b("#vrTour .modal-body .container-fluid").html(g.data.html);b("#vrTour").modal("show")}})})},showEditHotspot:function(c){var d=b(c).data();b(c).find(".editTourHotspot").on("click",function(e){b.ajax({url:"index.php",type:"POST",data:{id:d.tour.id,view:"tour",task:"ajaxGetHotspotEditorHtml"},async:true,cache:false}).done(function(g,h,f){if(g.status){b("#vrTour .modal-title").html('<i class="fa fa-plus-square" aria-hidden="true"></i> Add hotspot <br/><small>'+d.tour.name+"</small>");b("#vrTour .modal-body .container-fluid").html(g.data.html);b("#vrTour").modal("show")}})})},showPreview:function(c){var d=b(c).data();b(c).find(".previewTour").on("click",function(e){var f=window.open("./"+d.tour.alias,"_blank")})},hooks:function(){b("body").on("click",".addNew",function(){vrAdmin.Tours.addNew()});b("#vTours tbody tr").each(function(){vrAdmin.Tours.showEmbed(this);vrAdmin.Tours.showEdit(this);vrAdmin.Tours.showEditHotspot(this);vrAdmin.Tours.showPreview(this)})}}})(window,jQuery.noConflict());